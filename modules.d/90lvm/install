#!/bin/bash
inst lvm
inst dmeventd

if ldd $(which lvm) | grep -q lib64; then
    LIBDIR="/lib64"
else
    LIBDIR="/lib"
fi

inst_rules "$moddir/64-lvm.rules" 64-lvm.rules

if [[ $hostonly ]] || [[ $lvmconf = "yes" ]]; then 
    [ -f /etc/lvm/lvm.conf ] && inst /etc/lvm/lvm.conf
fi

for i in $(ls /$LIBDIR/libdevmapper-event*.so 2>/dev/null); do 
    dracut_install $i
done

inst_rules 10-dm.rules 13-dm-disk.rules 95-dm-notify.rules 11-dm-lvm.rules

inst "$moddir/lvm_scan.sh" /sbin/lvm_scan
inst_hook cmdline 30 "$moddir/parse-lvm.sh"
inst "$moddir/lvm-cleanup.sh" /sbin/lvm-cleanup
